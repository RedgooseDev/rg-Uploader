!function(){RGUploader.prototype.plugins.changeQueueStyle=function(){var e="Change queue style",t=null,n=null,i=null,o=[{name:"list",title:"list style",iconName:"menu","default":!0},{name:"web",title:"web style",iconName:"view_list","default":!1},{name:"album",title:"album style",iconName:"view_module","default":!1}],r=function(){$.each(o,function(e,t){var i=$('<button type="button" class="style-'+t.name+'" title="'+t.title+'" data-style="'+t.name+'"><i class="material-icons">'+t.iconName+"</i></button>");a(i),n.append(i)}),i=n.children("button")},a=function(e){e.on("click",function(e){return!$(this).hasClass("on")&&void t.queue.changeStyle($(this).data("style"))})},u=function(e){i.removeClass("on").filter(".style-"+e).addClass("on")};return{name:e,init:function(e){t=e,n=$('<nav data-element="selectQueueStyle"></nav>'),t.$container.children("header").append(n),r(),u(t.queue.style)},eventListener:function(e,t){switch(e){case"queue.changeStyle":u(t.style)}}}}}(),function(){RGUploader.prototype.plugins.dnd=function(){var e="Drag and Drop upload",t=null,n=[],i=$(".rg-external-dropzone"),o=function(e){if(!(window.File&&window.FileList&&window.FileReader&&window.Blob))return!1;if(!e.length)return!1;for(var t=$.Deferred(),n=!1,i=function(e){if(e.stopPropagation(),e.preventDefault(),"dragover"==e.type){if(n)return!1;n=!0,$(e.currentTarget).addClass("drop-mode"),e.dataTransfer.dropEffect="copy"}else n=!1,$(e.currentTarget).removeClass("drop-mode");return!1},o=function(e){e.stopPropagation(),e.preventDefault(),i(e);var n=e.dataTransfer?e.dataTransfer.files:null;return n&&n.length&&t.notify(n),!1},r=0;r<e.length;r++)e[r].addEventListener("dragover",i,!1),e[r].addEventListener("dragleave",i,!1),e[r].addEventListener("drop",o,!1);return t.promise()},r=function(e){return t.uploader.uploading?(alert(t.lang("error_add_upload")),!1):void t.uploader.play(t.uploader.$uploadElement,e||[])};return{name:e,init:function(e){if(t=e,n.push(t.queue.$queue.parent().get(0)),i.each(function(){n.push(this)}),n.length){var a=o(n);a&&a.progress&&a.progress(r)}}}}}(),function(){RGUploader.prototype.plugins.preview=function(){var e="preview",t=null,n=null,i="not-image",o=150,r=function(){var e='<div class="col preview"><figure></figure></div>';n=$(e),n.width(o),t.$container.find("[data-comp=queue]").prepend(n),a()},a=function(e){var t=n.children("figure");e?t.css("backgroundImage","url('"+e+"')").removeClass(i):t.attr("style","").addClass(i)},u=function(e){e?n.removeClass("hide"):n.addClass("hide")};return{name:e,init:function(e){t=e,o=parseInt(t.options.queue.height),r()},eventListener:function(e,n){switch(e){case"queue.selectQueue":var i=n.$selectElement.data("id"),o=t.queue.findItem(i),r=t.queue.items.files[o],l=n.$selectElement.hasClass("selected")&&"image"==r.type.split("/")[0]?r.src:null;a(l);break;case"queue.changeStyle":u("list"==n.style)}}}}}(),function(){RGUploader.prototype.plugins.sizeinfo=function(){var e="sizeinfo",t=null,n=null,i=".size-info",o=null,r=null,a={current:0,total:0},u=function(){o.text(t.util.bytesToSize(a.current)),r.text(t.util.bytesToSize(a.total))},l=function(){var e='<p>Size : <em data-text="currentSize"></em>/<em data-text="totalSize"></em></p>';n.append(e),o=n.find("[data-text=currentSize]"),r=n.find("[data-text=totalSize]")};return{name:e,init:function(o){t=o,n=o.$container.find(i),n.length||t.plugin.error(e),l(),a.total=t.options.limitSizeTotal,u()},update:u,eventListener:function(e,n){switch(e){case"queue.uploadComplete":a.current+=n.file.size,u(t.queue.getSize());break;case"queue.removeQueue":a.current=t.queue.getSize(),u()}}}}}(),function(){RGUploader.prototype.plugins.thumbnail=function(){function e(){var e=document.getElementsByTagName("head")[0],t=document.createElement("link"),n=document.createElement("script");t.rel="stylesheet",t.href="../vendor/croppie/croppie.css",n.src="../vendor/croppie/croppie.min.js",e.appendChild(t),e.appendChild(n)}function t(){f.con=$('<div class="rg-plugin-thumbnail"><span class="bg"></span><div class="wrap"><div class="img-wrap"><figure></figure></div><div class="body"><div class="meta"><p>message</p></div><nav><button type="button" class="btn-done"><i class="material-icons">done</i></button><button type="button" class="btn-close"><i class="material-icons">close</i></button></nav></div></div></div>'),f.wrap=f.con.children(".wrap"),f.bg=f.con.children(".bg"),f.figure=f.con.find(".img-wrap figure"),f.meta=f.con.find(".meta > p"),f.btn_done=f.con.find(".btn-done"),f.btn_close=f.con.find(".btn-close"),$("body").append(f.con)}function n(){f.bg.on("click",s),f.btn_close.on("click",s),f.btn_done.on("click",d),$(window).on(h,r)}function i(e){return!(!e&&g)&&(g=!0,f.wrap.width("100%").height("100%").css({marginLeft:0,marginTop:0,left:0,top:0}),void(w&&a(!0)))}function o(e){return!(!e&&!g)&&(g=!1,f.wrap.width(m.width).height(m.height).css({marginLeft:0-.5*m.width+"px",marginTop:0-.5*m.height+"px",left:"50%",top:"50%"}),void(w&&a(!0)))}function r(e){var t=$(window);return w?(v&&clearTimeout(v),void(v=setTimeout(function(){return g&&t.width()<640?(i(!0),!1):void(t.width()<640?i(!0):t.width()>640&&o(!0))},300))):(clearTimeout(v),!1)}function a(e){var t=e?w.get():{};u(),m.croppie.boundary={width:m.mobileSize>$(window).width()?$(window).width():m.width,height:(m.mobileSize>$(window).width()?$(window).height():m.height)-60},w=new Croppie(f.figure.get(0),m.croppie),e&&(w.bind({url:b.src,points:t.points}),w.setZoom(t.zoom))}function u(){w&&(w.destroy(),w=null)}function l(e){f.con.addClass("show"),b=e,$(window).width()<m.mobileSize?i(!0):o(!0),a(),w.bind({url:b.src}),f.meta.text("output size: "+m.output.size.width+"*"+m.output.size.height)}function s(){u(),b=null,f.con.removeClass("show")}function d(e){w.result(m.output).then(function(e){$("#result").append('<img src="'+e+'" alt="">'),m.uploadScript?$.post(m.uploadScript,{name:b.name,image:e,id:p.util.getUniqueNumber()},function(e){try{e=JSON.parse(e)}catch(t){return alert("parse error"),!1}return"error"==e.state?(alert(e.message),!1):void p.queue["import"]([e.response])}):p.queue["import"]([{id:p.util.getUniqueNumber(),name:"thumb-"+b.name,src:e,type:"image/"+m.output.format,size:0}]),s()})}var c="Create thumnail image",p=null,f={con:null,wrap:null,bg:null,figure:null,meta:null,btn_close:null,btn_done:null},m={width:640,height:480,mobileSize:640,uploadScript:"./script/upload_base64.php",output:{type:"canvas",quality:.3,format:"jpeg",size:{width:150,height:150}}},h="resize.rgUploader",g=!1,v=null,w=null,b=null;return m.croppie={boundary:{width:m.width,height:m.height-60},viewport:{width:150,height:150,type:"square"}},{name:c,init:function(i){p=i,e(),t(),n()},open:l,close:s}}}();
//# sourceMappingURL=maps/plugin.pkgd.js.map
