function RG_ChangeQueueStyle(){this.name="Change Queue Style",this.buttonsParams=[{name:"list",title:"list style",iconName:"menu","default":!0},{name:"web",title:"web style",iconName:"view_list","default":!1},{name:"album",title:"album style",iconName:"view_module","default":!1}],this.$nav=null,this.$buttons=null;var e=this,t=null,i=function(){$.each(e.buttonsParams,function(t,i){var o=$('<button type="button" class="style-'+i.name+'" title="'+i.title+'" data-style="'+i.name+'"><i class="material-icons">'+i.iconName+"</i></button>");n(o),e.$nav.append(o)}),e.$buttons=e.$nav.children("button")},n=function(e){e.on("click",function(e){return!$(this).hasClass("on")&&void t.queue.changeStyle($(this).data("style"))})},o=function(t){e.$buttons.removeClass("on").filter(".style-"+t).addClass("on")};this.init=function(n){t=n,e.$nav=$('<nav data-element="selectQueueStyle"></nav>'),t.$container.children("header").append(e.$nav),i(),o(t.queue.style)},this.eventListener=function(e,t){switch(e){case"queue.changeStyle":o(t.style)}}}function RG_DragAndDrop(){this.name="Drag And Drop",this.areaElements=[];var e=this,t=null,i=$(".rg-external-dropzone"),n=function(e){if(!(window.File&&window.FileList&&window.FileReader&&window.Blob))return!1;if(!e.length)return!1;for(var t=$.Deferred(),i=!1,n=function(e){if(e.stopPropagation(),e.preventDefault(),"dragover"==e.type){if(i)return!1;i=!0,$(e.currentTarget).addClass("drop-mode"),e.dataTransfer.dropEffect="copy"}else i=!1,$(e.currentTarget).removeClass("drop-mode");return!1},o=function(e){e.stopPropagation(),e.preventDefault(),n(e);var i=e.dataTransfer?e.dataTransfer.files:null;return i&&i.length&&t.notify(i),!1},a=0;a<e.length;a++)e[a].addEventListener("dragover",n,!1),e[a].addEventListener("dragleave",n,!1),e[a].addEventListener("drop",o,!1);return t.promise()},o=function(e){return t.uploader.uploading?(alert(t.lang("error_add_upload")),!1):void t.uploader.play(t.uploader.$uploadElement,e||[])};this.init=function(a){if(t=a,this.areaElements.push(t.queue.$queue.parent().get(0)),i.each(function(){e.areaElements.push(this)}),this.areaElements.length){var l=n(this.areaElements);l&&l.progress&&l.progress(o)}}}function RG_Preview(){this.name="Preview",this.$preview=null;var e=this,t=null,i="not-image",n=150,o=function(){var i='<div class="col preview"><figure></figure></div>';e.$preview=$(i),e.$preview.width(n),t.$container.find("[data-comp=queue]").prepend(e.$preview),a()},a=function(t){var n=e.$preview.children("figure");t?n.css("backgroundImage","url('"+t+"')").removeClass(i):n.attr("style","").addClass(i)},l=function(t){t?e.$preview.removeClass("hide"):e.$preview.addClass("hide")};this.init=function(e){t=e,n=parseInt(t.options.queue.height),o()},this.eventListener=function(e,i){switch(e){case"queue.selectQueue":var n=i.$selectElement.data("id"),o=t.queue.findItem(n),r=t.queue.items.files[o],s=i.$selectElement.hasClass("selected")&&"image"==r.type.split("/")[0]?r.src:null;a(s);break;case"queue.changeStyle":l("list"==i.style)}}}function RG_Sizeinfo(){this.name="Size info",this.size={current:0,total:0};var e=this,t=null,i=null,n=".size-info",o=null,a=null,l=function(){var e='<p>Size : <em data-text="currentSize"></em>/<em data-text="totalSize"></em></p>';i.append(e),o=i.find("[data-text=currentSize]"),a=i.find("[data-text=totalSize]")};this.init=function(e){t=e,i=e.$container.find(n),i.length||t.plugin.error(name),l(),this.size.total=t.options.limitSizeTotal,this.update()},this.update=function(){o.text(t.util.bytesToSize(this.size.current)),a.text(t.util.bytesToSize(this.size.total))},this.eventListener=function(i,n){switch(i){case"queue.uploadComplete":e.size.current+=n.file.size,e.update(t.queue.getSize());break;case"queue.removeQueue":e.size.current=t.queue.getSize(),e.update()}}}function RG_Thumbnail(){function e(){if(window.loadedCroppie)return!1;var e=document.getElementsByTagName("head")[0],t=document.createElement("link"),i=document.createElement("script");t.rel="stylesheet",t.href="../vendor/croppie/croppie.css",i.src="../vendor/croppie/croppie.min.js",e.appendChild(t),e.appendChild(i),window.loadedCroppie=!0}function t(){u.$el.con=$('<div class="rg-plugin-thumbnail"><span class="bg"></span><div class="wrap"><div class="img-wrap"><figure></figure></div><div class="body"><div class="meta"><p>message</p></div><nav><button type="button" class="btn-done"><i class="material-icons">done</i></button><button type="button" class="btn-close"><i class="material-icons">close</i></button></nav></div></div></div>'),u.$el.wrap=u.$el.con.children(".wrap"),u.$el.bg=u.$el.con.children(".bg"),u.$el.figure=u.$el.con.find(".img-wrap figure"),u.$el.meta=u.$el.con.find(".meta > p"),u.$el.btn_done=u.$el.con.find(".btn-done"),u.$el.btn_close=u.$el.con.find(".btn-close"),$("body").append(u.$el.con)}function i(){u.$el.bg.on("click",function(){u.close()}),u.$el.btn_close.on("click",function(){u.close()}),u.$el.btn_done.on("click",s),$(window).on(c,a)}function n(e){return!(!e&&d)&&(d=!0,u.$el.wrap.width("100%").height("100%").css({marginLeft:0,marginTop:0,left:0,top:0}),void(u.croppie&&l(!0)))}function o(e){return!(!e&&!d)&&(d=!1,u.$el.wrap.width(u.option.width).height(u.option.height).css({marginLeft:0-.5*u.option.width+"px",marginTop:0-.5*u.option.height+"px",left:"50%",top:"50%"}),void(u.croppie&&l(!0)))}function a(e){var t=$(window);return u.croppie?(h&&clearTimeout(h),void(h=setTimeout(function(){return d&&t.width()<640?(n(!0),!1):void(t.width()<640?n(!0):t.width()>640&&o(!0))},300))):(clearTimeout(h),!1)}function l(e){var t=e?u.croppie.get():{};r(),u.option.croppie.boundary={width:u.option.mobileSize>$(window).width()?$(window).width():u.option.width,height:(u.option.mobileSize>$(window).width()?$(window).height():u.option.height)-60},u.croppie=new Croppie(u.$el.figure.get(0),u.option.croppie),e&&(u.croppie.bind({url:u.file.src,points:t.points}),u.croppie.setZoom(t.zoom))}function r(){u.croppie&&(u.croppie.destroy(),u.croppie=null)}function s(e){u.croppie.result(u.option.output).then(function(e){u.option.uploadScript?$.post(u.option.uploadScript,{name:u.file.name,image:e,id:p.util.getUniqueNumber()},function(e){try{e=JSON.parse(e)}catch(t){return alert("parse error"),!1}return"error"==e.state?(alert(e.response.message),!1):void p.queue["import"]([e.response])}):p.queue["import"]([{id:p.util.getUniqueNumber(),name:"thumb-"+u.file.name,src:e,type:"image/"+u.option.output.format,size:0}]),u.close()})}this.name="Make thumbnail";var u=this,p=null,c="resize.rgUploader",d=!1,h=null;this.file=null,this.croppie=null,this.$el={con:null,wrap:null,bg:null,figure:null,meta:null,btn_close:null,btn_done:null},this.option={width:640,height:480,mobileSize:640,uploadScript:"./script/upload_base64.php",output:{type:"canvas",quality:.3,format:"jpeg",size:{width:150,height:150}},croppie:{boundary:{width:640,height:420},viewport:{width:150,height:150,type:"square"}}},this.init=function(n){p=n,e(),t(),i()},this.open=function(e){this.$el.con.addClass("show"),$("html").addClass("rg-popup"),this.file=e,$(window).width()<this.option.mobileSize?n(!0):o(!0),l(),this.croppie.bind({url:this.file.src}),this.$el.meta.text("output size: "+this.option.output.size.width+"*"+this.option.output.size.height)},this.close=function(){r(),this.file=null,this.$el.con.removeClass("show"),$("html").removeClass("rg-popup")},this.assignOption=function(e){this.option=$.extend({},this.option,e)}}
//# sourceMappingURL=maps/plugin.pkgd.js.map
